@{
    Layout = null;
}

<!--右侧实体内容-->
<el-main id="partPage" style="position:relative;">
    <!--标题-->
    <div class="head-fixed" onclick="loadPage('/Main/approval')">
        <i class="el-icon-arrow-left"></i>
        日志管理
    </div>
    <!--物料搜索-->
    <div>
        <span style="color:red">*</span><span style="padding:3px;">关键字</span>
        <sam-input :value.sync="key" style="width:200px;" placeholder="请输入搜索关键字"></sam-input>
        <el-button type="primary" v-on:click="search">搜索</el-button>
        @*<el-input v-model="value" type="textarea"></el-input>*@
        <!--物料列表表格實體-->
        <el-table :data="tableData" stripe border>
            <el-table-column type="expand">
                <template slot-scope="props">
                    <el-form label-position="left" inline class="demo-table-expand">
                        <el-form-item label="报错堆栈">
                            <span>{{ props.row.StackTrace }}</span>
                        </el-form-item>
                        <el-form-item label="请求参数">
                            <span>{{ props.row.RequstResult }}</span>
                        </el-form-item>
                    </el-form>
                </template>
            </el-table-column>
            <el-table-column prop="Id" label="Id"></el-table-column>
            <el-table-column prop="ErrorMsg" label="报错信息"></el-table-column>
            <el-table-column prop="Method" label="调用方式"></el-table-column>
            <el-table-column prop="RequestUrl" label="接口Url"></el-table-column>
            <el-table-column prop="RequestIp" label="客户端Ip"></el-table-column>
            <el-table-column prop="CreateTime" label="时间"></el-table-column>
            @*<el-table-column label="操作">
            <template slot-scope="scope">
                <p v-if="noList.indexOf(scope.row.fNumber) >= 0">已选择</p>
                <el-button v-else size="mini" v-on:click="showdetail(scope.row)">选择</el-button>
            </template>
        </el-table-column>*@
        </el-table>
        <!--底部翻頁-->
        <div style="text-align:right">
            <el-pagination v-on:size-change="handleSizeChange"
                           v-on:current-change="handleCurrentChange"
                           :current-page="currentPage"
                           :page-sizes="[1, 3, 5, 10]"
                           :page-size="pageSize"
                           layout="total, sizes, prev, pager, next, jumper"
                           :total="totalRows">
            </el-pagination>
        </div>
        <hr />
        @*<el-form v-on:submit.native.prevent :model="ruleForm" :rules="rules" ref="ruleForm" label-width="100px" class="demo-ruleForm"
                 id="uploadForm" enctype="multipart/form-data">
            <el-form-item v-for="(v,k) in detail" :label="k" key="k">
                <el-input :value="v" type="textarea" :autosize="{ minRows: 2, maxRows: 4}"></el-input>
            </el-form-item>
        </el-form>*@
    </div>
   
   
    
</el-main>

<script>
    var demo = new Vue({
        el: "#partPage",
        mixins: [mixin],
        data: function () {
            return {
                key: '',
                data: [],
                tableData: [],
                detail: {}
            }
        },
        methods: {
            //搜索物料列表
            search(formName) {
                var url = 'ContextError/Read?key=' + this.key
                if (!this.key) {
                    url = 'ContextError/Read'
                }
                this.GetData(url, (res) => {
                    this.data = res
                    this.totalRows = res.length
                    this.getData()
                })
            },
            showdetail(row) {
                this.detail = row
            }
        },
        created: function () {
            this.search()
            loadHtml("mainPage", "partPage")
        }
    })
</script>



